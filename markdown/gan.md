| [返回主页](index.html) |

---



## 1. GAN

GAN 同时训练生成器与判别器，生成器输入随机噪声输出图像， <br>
判别器输入图像，输出是否为真实图像的置信度。（0~1, 1真, 0假）

```python
# 基本算法

0. 初始化生成器与判别器的网络参数
1. 从数据库中选取一批真实图像，给它们标签:1
2. 制造一批随机噪声经过生成器，得到一批生成图像，给它们标签:0
3. 调整判别器参数区分这两种图像（BCE损失函数见下图）
4. 再制造一批随机噪声，给它们标签:1
5. 将噪声输入生成器得到图像再输入判别器得到输出
6. 固定判别器，调整生成器参数（BCE）
7. 重复步骤1.
```

$$
BCELoss(\hat y, y) =
\frac{1}{n}\sum^n_{i=1}-y_ilog\hat y_i -(1-y_i)log(1-\hat y_i)
$$

**Auto-Encoder 的陷阱：**

在自编码器中，先输入图像，经过网络输出一个向量（这个向量表示图像的高层语义信息）<br>
最后再输入生成器输出图像，我们让这个输出图像与输入图像像素上越接近越好。<br>
由于最终的接近判断是像素级别的差异，不能像 GAN 那样做更加语义层面的鉴别，因此欠缺泛化力。

**对抗生成机制解释：**

一开始，生成器得到的样本与真实样本落到样本分布中的一些区域<br>
判别器调整其分布以区分生成样本与真实样本<br>
下一步中，生成器调整其参数，使判别器以为它的输出是真的，即找到判别器的 **弱点** <br>
判别器调整其参数来弥补这个弱点，迭代后，真实样本的分布与生成样本的分布会不断接近直到重合。

![](img\gan1.jpg)





## 2. Conditional GAN

输入文字与一个随机向量，输出生成的对应文字的图像。

```python
# 基本算法

0. 初始化生成器与判别器的网络参数
1. 从数据库中选取一批真实图像与其对应的文字(x,c)，给它们标签:1
2. 制造一批随机噪声经过生成器，得到一批生成图像，每个图配一个随机文字(x`,c)，给它们标签:0
3. 调整判别器参数区分这两种图像（BCE损失函数见下图）
4. 再制造一批随机噪声，给它们标签:1
5. 将噪声输入生成器得到图像再输入判别器得到输出
6. 固定判别器，调整生成器参数（BCE）
7. 重复步骤1.
```





